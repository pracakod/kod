/* ==========================================================================
   Lista — Animacje i efekty (mobile‑first)
   Plik: css/animations.css
   Sterowanie:
   - body.animations-on  → animacje włączone
   - body:not(.animations-on) → animacje i przejścia wyłączone
   - @media (prefers-reduced-motion: reduce) → redukcja ruchu
   ========================================================================== */

:root {
  --anim-fast: 140ms;
  --anim-med: 220ms;
  --anim-slow: 360ms;
  --easing-in: cubic-bezier(.4, 0, .2, 1);
  --easing-out: cubic-bezier(0, 0, .2, 1);
}

/* Globalne wyłączenie animacji */
body:not(.animations-on) * {
  animation: none !important;
  transition: none !important;
}
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 1ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 1ms !important;
    scroll-behavior: auto !important;
  }
}

/* Wejścia/Wyjścia */
@keyframes fadeIn   { from { opacity: 0 } to { opacity: 1 } }
@keyframes fadeOut  { from { opacity: 1 } to { opacity: 0 } }
@keyframes slideUp  { from { transform: translateY(12px); opacity: 0 } to { transform: translateY(0); opacity: 1 } }
@keyframes slideDown{ from { transform: translateY(-12px); opacity: 0 } to { transform: translateY(0); opacity: 1 } }
@keyframes slideInRight { from { transform: translateX(12px); opacity: 0 } to { transform: translateX(0); opacity: 1 } }
@keyframes slideInLeft  { from { transform: translateX(-12px); opacity: 0 } to { transform: translateX(0); opacity: 1 } }
@keyframes scaleIn { from { transform: scale(.96); opacity: 0 } to { transform: scale(1); opacity: 1 } }
@keyframes popIn   { 0% { transform: scale(.9); opacity: 0 } 60% { transform: scale(1.02); opacity: 1 } 100% { transform: scale(1); } }

/* Snackbar */
.snackbar.show {
  animation: slideUp var(--anim-fast) var(--easing-out);
}

/* Action Sheet */
.action-sheet:not([hidden]) { animation: fadeIn var(--anim-fast) var(--easing-out); }
.action-sheet .action-sheet-content {
  animation: sheetIn var(--anim-med) var(--easing-out);
}
@keyframes sheetIn {
  from { transform: translateY(16px); opacity: 0 }
  to   { transform: translateY(0);    opacity: 1 }
}

/* Drawer */
.drawer[aria-hidden="false"] {
  will-change: transform;
}
.drawer.anim-enter { animation: slideInLeft var(--anim-med) var(--easing-out); }
.drawer.anim-leave { animation: slideInRight var(--anim-med) var(--easing-in) reverse; }

/* Dialogi */
.dialog[open] .dialog-content {
  animation: scaleIn var(--anim-med) var(--easing-out);
}

/* FAB */
.fab.appear { animation: popIn var(--anim-med) var(--easing-out); }

/* Offline banner */
#offline-banner.show {
  animation: slideDown var(--anim-fast) var(--easing-out);
}

/* Karty i elementy listy (po dodaniu) */
.item.anim-added,
.card-item.anim-added {
  animation: slideUp var(--anim-med) var(--easing-out);
}

/* Ikony — ruch i stany */
.spin { animation: spin 1s linear infinite; }
@keyframes spin { to { transform: rotate(360deg) } }

.pulse { animation: pulse 1.2s var(--easing-in) infinite; }
@keyframes pulse {
  0%, 100% { transform: scale(1); opacity: 1 }
  50% { transform: scale(1.05); opacity: .85 }
}

/* Skeleton (ładowanie danych) */
.skeleton {
  position: relative;
  overflow: hidden;
  color: transparent !important;
  background: linear-gradient(90deg, var(--surface-2) 25%, var(--surface-3) 37%, var(--surface-2) 63%);
  background-size: 400% 100%;
  animation: shimmer 1.2s linear infinite;
  user-select: none;
}
@keyframes shimmer {
  0% { background-position: 100% 0 }
  100% { background-position: 0 0 }
}

/* Ripple (efekt dotykowy) — wymaga dodania klasy .ripple-animate przez JS */
.has-ripple { position: relative; overflow: hidden; }
.has-ripple::after {
  content: "";
  position: absolute;
  left: var(--rx, 50%); top: var(--ry, 50%);
  width: 20px; height: 20px;
  transform: translate(-50%, -50%) scale(0);
  background: currentColor;
  opacity: .18;
  border-radius: 50%;
  pointer-events: none;
}
.has-ripple.ripple-animate::after {
  animation: ripple .55s ease-out;
}
@keyframes ripple {
  from { transform: translate(-50%, -50%) scale(0); opacity: .25 }
  to   { transform: translate(-50%, -50%) scale(16); opacity: 0 }
}

/* Podpowiedzi gestów (swipe) — opcjonalne klasy */
.swipeable.hint-left  { background: linear-gradient(90deg, color-mix(in oklab, var(--danger) 10%, transparent), transparent); }
.swipeable.hint-right { background: linear-gradient(270deg, color-mix(in oklab, var(--success) 10%, transparent), transparent); }

/* Kalendarz — puls dzisiejszej daty */
.cal-today {
  position: relative;
  z-index: 0;
}
.cal-today::after {
  content: "";
  position: absolute;
  inset: 4px 4px auto auto;
  width: 8px; height: 8px;
  background: var(--primary);
  border-radius: 50%;
  opacity: .85;
  animation: pulse 1.6s var(--easing-in) infinite;
}

/* Znacznik powiadomień (np. na ikonach) */
.notify-dot {
  position: relative;
}
.notify-dot::after {
  content: "";
  position: absolute;
  top: -2px; right: -2px;
  width: 8px; height: 8px;
  background: var(--danger);
  border: 2px solid var(--bg);
  border-radius: 50%;
}

/* Animacja wejścia pozycji w listach kart (lojalnościowe, przepisy, wakacje) */
.card-list > .card-item { transform-origin: 50% 0; }
.card-list > .card-item.anim-enter { animation: fadeIn var(--anim-med) var(--easing-out), slideUp var(--anim-med) var(--easing-out); }

/* Animacja przełączania zakładek (dolne menu) */
.view.active {
  animation: fadeIn var(--anim-fast) var(--easing-out);
}

/* Kontrolowane zanikanie elementów (np. usuwanie) */
.anim-fade-out {
  animation: fadeOut var(--anim-fast) var(--easing-in) forwards;
}

/* Subtelne podświetlenie po zapisie */
.flash-saved {
  animation: flashSaved 900ms var(--easing-out);
}
@keyframes flashSaved {
  0%   { box-shadow: 0 0 0 0 color-mix(in oklab, var(--success) 35%, transparent); }
  100% { box-shadow: 0 0 0 0 transparent; }
}