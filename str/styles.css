:root{
  --bg: #f6f7fb;
  --text: #111318;
  --muted: #566074;
  --card: #ffffff;
  --border: #e6e8f0;
  --accent: #4a90e2;
  --accent-soft: rgba(74,144,226,0.12);
  --shadow: 0 8px 24px rgba(17,19,24,0.08);
  --shadow-soft: 0 4px 12px rgba(17,19,24,0.06);
  --radius: 16px;
  --header-h: 64px;
  --nav-h: 72px;
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-top: env(safe-area-inset-top);
  --focus: 0 0 0 3px rgba(74,144,226,0.3);
  --danger: #d53b3b;

  /* Neon gradient – nadpisywane dynamicznie w JS na bazie --accent */
  --neo1: #4ab0ff; /* fallback */
  --neo2: #a14ae2; /* fallback */

  /* Wygląd – domyślne wartości */
  --ring-blur: 8px;
  --ring-pad: 1px;
  --item-radius: 18px;
  --item-shadow-opa: 0.06;
}

[data-theme="dark"]{
  --bg: #0c0f14;
  --text: #e6e8ef;
  --muted: #9aa3b2;
  --card: #161a22;
  --border: #232938;
  --shadow: 0 8px 24px rgba(0,0,0,0.45);
  --shadow-soft: 0 4px 12px rgba(0,0,0,0.35);
  --accent-soft: color-mix(in oklab, var(--accent) 15%, transparent);
}

*{box-sizing: border-box}
html,body{height:100%}
body{
  margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
  background: var(--bg); color: var(--text); -webkit-tap-highlight-color: transparent;
}
button,input,select{font-family:inherit; color:inherit}

.app{ min-height:100dvh; display:flex; flex-direction:column; padding-top:var(--safe-top); }

/* Header */
.app-header{
  position:sticky; top:0; z-index:20; height:var(--header-h);
  backdrop-filter: blur(8px);
  background: var(--bg); /* fallback */
  background: linear-gradient(180deg, color-mix(in oklab, var(--accent) 12%, var(--bg)) 0%, var(--bg) 70%);
  border-bottom: 1px solid var(--border);
  display:flex; align-items:center; padding:0 16px;
}
.title-button{
  display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:12px;
  background: var(--card); box-shadow: var(--shadow-soft); border:1px solid var(--border);
  cursor:pointer; user-select:none;
}
.title-button:active{transform:scale(0.98)}
.dot{ width:10px; height:10px; border-radius:50%; background:var(--accent); box-shadow:0 0 0 3px var(--accent-soft) }
.list-icon{ font-size:16px; line-height:1; }
.title-text{font-weight:600}
.caret{width:16px; height:16px; opacity:0.7}

/* Dropdown */
.dropdown{
  position:absolute; top: calc(var(--header-h) - 6px); left:12px; right:12px;
  background: var(--card); border:1px solid var(--border); border-radius:18px;
  box-shadow: var(--shadow); padding:8px; display:none; max-height:60dvh; overflow:auto;
}
.dropdown.open{display:block; animation: pop 160ms ease-out}
@keyframes pop{from{transform:translateY(-8px); opacity:0} to{transform:translateY(0); opacity:1}}

.menu-sec-title{font-size:12px; color:var(--muted); padding:6px 10px}
.menu-item{
  display:flex; align-items:center; gap:10px; width:100%; border:0; background:transparent;
  padding:10px; border-radius:12px; cursor:pointer; user-select:none;
}
.menu-item:hover{background: color-mix(in oklab, var(--card) 92%, var(--accent) 8%)}
.menu-item .name{flex:1; text-align:left}
.pill{background: var(--accent-soft); color: var(--accent); border-radius:999px; font-size:12px; padding:2px 8px}
.color-dot{width:10px; height:10px; border-radius:50%}
.grip{opacity:.5; display:grid; place-items:center; cursor:grab}
.menu-item.drag-over{outline:2px dashed var(--accent); outline-offset:2px}

/* Active item highlight */
.menu-item.is-active{
  background: color-mix(in oklab, var(--card) 85%, var(--accent) 15%);
  outline: 2px solid var(--accent);
}
.tick{display:none}
.menu-item.is-active .tick{display:block}

/* Main content */
main{flex:1; padding:12px 12px calc(var(--nav-h) + var(--safe-bottom) + 12px); max-width:900px; width:100%; margin:0 auto}
.list{ display:grid; gap:8px; }
.empty{ color:var(--muted); text-align:center; margin-top:18vh; font-size:15px; }

/* Item */
.item{
  display:flex; align-items:center; gap:12px; background: var(--card); border:1px solid var(--border);
  padding:12px; border-radius:14px; box-shadow: var(--shadow-soft);
  transition: transform .15s ease, background .2s ease, opacity .2s ease;
}
.item.new{animation: slideIn .18s ease-out}
@keyframes slideIn{from{transform:translateY(8px); opacity:.0} to{transform:translateY(0); opacity:1}}
.item:active{transform:scale(0.995)}

/* Bright custom checkboxes in list items */
.item input[type="checkbox"]{
  -webkit-appearance:none; appearance:none;
  width:22px; height:22px; border-radius:6px; flex-shrink:0;
  border:2px solid var(--border); background: var(--card);
  display:grid; place-items:center; transition: background .15s, border-color .15s, transform .1s;
}
.item input[type="checkbox"]:active{ transform: scale(0.96) }
.item input[type="checkbox"]:checked{
  background: var(--accent); border-color: var(--accent);
}
.item input[type="checkbox"]:checked::after{
  content:''; width:10px; height:6px; border-left:2px solid #fff; border-bottom:2px solid #fff; transform: rotate(-45deg); margin-top:-1px;
}

.item .texts{display:flex; flex-direction:column; gap:4px; flex:1; min-width:0}
.item .text{ font-size:16px; line-height:1.35; word-break:break-word; transition: color .2s ease; }
.item.done .text{color: var(--muted); text-decoration: line-through; text-decoration-thickness: 1.5px}
.sub{color: var(--muted); font-size:12px}

/* Edit mode */
.edit-on .item input[type="checkbox"]{display:none}
.edit-on .item .text{border:1px dashed transparent; border-radius:8px; padding:4px 6px}
.edit-on .item .text[contenteditable="true"]:focus{border-color: var(--accent); outline:none; box-shadow: var(--focus)}
.item .handle{ display:none; width:24px; height:24px; opacity:.55; flex-shrink:0; cursor:grab; }
.edit-on .item .handle{display:block}
.item .actions{display:none; gap:6px; align-items:center}
.edit-on .item .actions{display:flex}
.i-btn{ width:34px; height:34px; display:grid; place-items:center; border-radius:10px; border:1px solid var(--border); background: var(--card); }
.i-btn:active{transform:scale(0.96)}
.i-btn.danger{color: var(--danger); border-color: color-mix(in oklab, var(--danger) 30%, var(--border)); background: color-mix(in oklab, var(--danger) 10%, var(--card))}
.item.drag-over{ outline:2px dashed var(--accent); outline-offset:2px; }
.item.dragging{ opacity:.98; box-shadow: 0 12px 28px rgba(0,0,0,.18); transform: scale(1.01); }
.placeholder{ border:2px dashed var(--border) !important; background: color-mix(in oklab, var(--card) 80%, var(--accent) 20%) !important; }

/* Bottom nav */
.bottom-nav{
  position:fixed; left:0; right:0; bottom:0; height: calc(var(--nav-h) + var(--safe-bottom));
  padding-bottom: var(--safe-bottom);
  background: var(--card); border-top:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; padding:0 16px; z-index:25;
  gap:12px;
}
.nav-left, .nav-right{display:flex; gap:10px; align-items:center}
.icon-btn{
  width:44px; height:44px; border-radius:12px; border:1px solid var(--border); background:var(--card); display:grid; place-items:center;
  box-shadow: var(--shadow-soft);
}
.icon-btn:active{transform:scale(0.96)}
.icon-btn.active{outline:2px solid var(--accent); outline-offset:2px}
.fab{
  position:absolute; left:50%; transform: translateX(-50%) translateY(-16%);
  width:56px; height:56px; border-radius:50%;
  border:0; background: linear-gradient(135deg, var(--accent), color-mix(in oklab, var(--accent) 60%, #fff));
  color:#fff; display:grid; place-items:center; box-shadow: 0 10px 24px color-mix(in oklab, var(--accent) 30%, transparent);
}
.fab:active{transform: translateX(-50%) translateY(-16%) scale(0.97)}
.disabled, .icon-btn[disabled], .btn[disabled]{opacity:.45; pointer-events:none; filter: grayscale(.1);}

/* Quick add */
.quick-add{
  position: fixed; left:12px; right:12px; bottom: calc(var(--nav-h) + var(--safe-bottom) + 10px);
  background: var(--card); border:1px solid var(--border); border-radius:14px; box-shadow: var(--shadow);
  display:none; padding:8px; gap:8px; align-items:center;
}
.quick-add.open{display:flex; animation: pop .12s ease-out}
.quick-add input{ flex:1; border:0; background:transparent; outline:none; padding:10px; border-radius:10px; }

/* Dialogs */
dialog{ border:0; border-radius:18px; padding:0; background: var(--card); color: var(--text); width:min(520px, 92vw); box-shadow: var(--shadow); }
dialog::backdrop{background: rgba(10,12,16,0.45); backdrop-filter: blur(3px)}
.dlg-head{padding:16px 18px; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between}
.dlg-title{font-weight:700}
.dlg-body{padding:14px 18px; display:grid; gap:12px}
.field{display:grid; gap:6px}
.label{font-size:13px; color:var(--muted)}
input[type="text"], select{ width:100%; border:1px solid var(--border); background: var(--card); color: var(--text); border-radius:12px; padding:12px; outline:none; }
.row{display:flex; gap:10px; align-items:center}
.row.wrap{flex-wrap:wrap}
.grow{flex:1}

/* Switch (tylko suwaczek) */
.switch{
  position:relative; width:48px; height:28px; background: var(--border);
  border-radius:999px; border:1px solid var(--border); display:inline-block;
}
.switch input{
  position:absolute; inset:0; width:100%; height:100%; margin:0;
  opacity:0; cursor:pointer; z-index:2;
}
.switch .knob{
  position:absolute; top:50%; left:4px; transform:translateY(-50%);
  width:20px; height:20px; border-radius:50%; background:#fff; box-shadow: var(--shadow-soft);
  transition: left .18s ease, background .18s ease;
  z-index:1;
}
.switch input:checked + .knob{ left:24px; background: var(--accent)}

.dlg-foot{display:flex; gap:10px; justify-content:flex-end; padding:14px 18px; border-top:1px solid var(--border)}
.btn{ padding:10px 14px; border-radius:12px; border:1px solid var(--border); background:var(--card); cursor:pointer; }
.btn.primary{ background: var(--accent); border-color: transparent; color:#fff; }
.btn.danger{color: var(--danger); border-color: color-mix(in oklab, var(--danger) 30%, var(--border)); background: color-mix(in oklab, var(--danger) 10%, var(--card))}
.hint{font-size:12px; color:var(--muted)}

/* Light checkboxes in dialogs */
dialog input[type="checkbox"]:not(.switch input){
  -webkit-appearance:none; appearance:none;
  width:18px; height:18px; border-radius:4px; border:2px solid var(--border); background: var(--card);
  display:inline-grid; place-items:center; vertical-align:middle; margin:0;
}
dialog input[type="checkbox"]:not(.switch input):checked{
  background: var(--accent); border-color: var(--accent);
}
dialog input[type="checkbox"]:not(.switch input):checked::after{
  content:''; width:8px; height:5px; border-left:2px solid #fff; border-bottom:2px solid #fff; transform: rotate(-45deg);
}

/* Color palette */
.swatch-grid{display:grid; grid-template-columns: repeat(10, 1fr); gap:8px}
.swatch{ width:28px; height:28px; border-radius:999px; border:2px solid #fff; box-shadow: 0 0 0 2px var(--border); cursor:pointer; }
.swatch.selected{box-shadow: 0 0 0 2px var(--accent)}

/* Ikonki */
.icon-grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(36px, 1fr)); gap:8px }
.icon-chip{
  width:36px; height:36px; display:grid; place-items:center; border-radius:10px;
  border:1px solid var(--border); background:var(--card); cursor:pointer; font-size:18px;
}
.icon-chip.selected{ outline:2px solid var(--accent) }

/* Ukryj UI przy systemowym druku (Ctrl+P) */
@media print {
  .app-header, .bottom-nav, .dropdown, dialog, .quick-add { display: none !important; }
  main { padding: 0 !important; }
  body { background: #fff !important; }
}
